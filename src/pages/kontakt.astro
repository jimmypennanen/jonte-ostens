---
import MainLayout from '../layouts/MainLayout.astro';
import Hero from '../components/Hero.astro';

export const prerender = false;
---

<MainLayout title="Kontakt">
  <Hero
    title="Kontakta Jonte"
    subtitle="Vi √§r h√§r f√∂r din ostresa"
  />

  <section class="section-padding bg-white">
    <div class="max-w-5xl mx-auto px-6 md:px-8">
      <div class="grid lg:grid-cols-2 gap-12">
        <!-- Contact Form -->
        <div>
          <h2 class="text-3xl font-display font-bold text-dark-brown mb-2">
            Skicka ett meddelande
          </h2>
          <p class="text-dark-brown/60 mb-8">
            Fyll i formul√§ret nedan och vi kontaktar dig s√• snart Jonte √§r klar med sin ost.
          </p>

          <form id="contact-form" class="space-y-6">
            <!-- Success Message -->
            <div id="success-message" class="hidden bg-green-100 border-l-4 border-green-500 text-green-700 p-4">
              <p>Tack f√∂r ditt meddelande! Vi kontaktar dig s√• snart Jonte √§r klar med sin ost.</p>
            </div>

            <!-- Error Message -->
            <div id="error-message" class="hidden bg-red-100 border-l-4 border-red-500 text-red-700 p-4">
              <p id="error-text"></p>
            </div>

            <!-- Name Field -->
            <div>
              <label for="name" class="block text-sm font-semibold text-dark-brown mb-2">
                Namn
              </label>
              <input
                type="text"
                id="name"
                name="name"
                required
                class="w-full px-4 py-3 rounded-lg border-2 border-dark-brown/20 focus:border-dark-green focus:outline-none text-dark-brown placeholder-dark-brown/40"
                placeholder="Ditt namn"
              />
            </div>

            <!-- Email Field -->
            <div>
              <label for="email" class="block text-sm font-semibold text-dark-brown mb-2">
                E-post
              </label>
              <input
                type="email"
                id="email"
                name="email"
                required
                class="w-full px-4 py-3 rounded-lg border-2 border-dark-brown/20 focus:border-dark-green focus:outline-none text-dark-brown placeholder-dark-brown/40"
                placeholder="din@epost.se"
              />
            </div>

            <!-- Subject Field -->
            <div>
              <label for="subject" class="block text-sm font-semibold text-dark-brown mb-2">
                √Ñmne
              </label>
              <select
                id="subject"
                name="subject"
                class="w-full px-4 py-3 rounded-lg border-2 border-dark-brown/20 focus:border-dark-green focus:outline-none text-dark-brown"
              >
                <option value="reservation">Reservation av ost</option>
                <option value="inquiry">Allm√§n fr√•ga</option>
                <option value="feedback">Feedback om ost</option>
                <option value="complaint">En ost-relaterad klagan</option>
                <option value="other">N√•got annat</option>
              </select>
            </div>

            <!-- Message Field -->
            <div>
              <label for="message" class="block text-sm font-semibold text-dark-brown mb-2">
                Meddelande
              </label>
              <textarea
                id="message"
                name="message"
                required
                rows={6}
                class="w-full px-4 py-3 rounded-lg border-2 border-dark-brown/20 focus:border-dark-green focus:outline-none text-dark-brown placeholder-dark-brown/40 resize-none"
                placeholder="Ber√§tta om ditt ost√§ventyr..."
              ></textarea>
            </div>

            <!-- Submit Button -->
            <button
              type="submit"
              id="submit-btn"
              class="w-full bg-dark-green text-cream px-6 py-4 rounded-lg font-bold text-lg hover:bg-dark-green/90 transition-colors"
            >
              Skicka meddelande
            </button>
          </form>

          <p class="text-xs text-dark-brown/50 mt-4 text-center">
            Vi svarar normalt inom 24 timmar (eller n√§r Jonte m√•r bra)
          </p>

          <script>
            const form = document.getElementById('contact-form') as HTMLFormElement;
            const successMessage = document.getElementById('success-message');
            const errorMessage = document.getElementById('error-message');
            const errorText = document.getElementById('error-text');
            const submitBtn = document.getElementById('submit-btn') as HTMLButtonElement;

            form?.addEventListener('submit', async (e: Event) => {
              e.preventDefault();

              // Hide previous messages
              successMessage?.classList.add('hidden');
              errorMessage?.classList.add('hidden');

              // Disable submit button
              submitBtn.disabled = true;
              const originalText = submitBtn.textContent;
              submitBtn.textContent = 'Skickar...';

              const formData = new FormData(form);
              const name = formData.get('name') as string;
              const email = formData.get('email') as string;
              const subject = formData.get('subject') as string;
              const message = formData.get('message') as string;

              try {
                const response = await fetch('/api/contact/submit', {
                  method: 'POST',
                  headers: {
                    'Content-Type': 'application/json',
                  },
                  body: JSON.stringify({ name, email, subject, message }),
                });

                if (response.ok) {
                  // Show success message
                  successMessage?.classList.remove('hidden');
                  form.reset();
                } else {
                  const error = await response.json();
                  errorText!.textContent = error.error || 'Ett fel uppstod vid s√§ndning av meddelandet';
                  errorMessage!.classList.remove('hidden');
                }
              } catch (error) {
                errorText!.textContent = 'Ett fel uppstod. F√∂rs√∂k igen senare.';
                errorMessage!.classList.remove('hidden');
                console.error('Form error:', error);
              } finally {
                // Re-enable submit button
                submitBtn.disabled = false;
                submitBtn.textContent = originalText;
              }
            });
          </script>
        </div>

        <!-- Contact Info -->
        <div class="space-y-8">
          <!-- Phone -->
          <div class="bg-cream rounded-2xl p-8 border-2 border-soft-yellow">
            <h3 class="text-xl font-display font-bold text-dark-brown mb-4">
              üìû Ring Jonte
            </h3>
            <p class="text-dark-brown/70 mb-4">
              Ring n√§r som helst, men han svarar bara n√§r han √§ter ost (vilket √§r alltid).
            </p>
            <a href="tel:+46123456789" class="text-2xl font-bold text-dark-green hover:underline">
              +46 (1) 23 45 67 89
            </a>
            <p class="text-xs text-dark-brown/50 mt-4">
              Han kan inte garantera att han l√•ter sin telefon k√§nna smak.
            </p>
          </div>

          <!-- Address -->
          <div class="bg-soft-yellow rounded-2xl p-8">
            <h3 class="text-xl font-display font-bold text-dark-brown mb-4">
              üìç Bes√∂k oss
            </h3>
            <p class="text-dark-brown/70 mb-4">
              Jontes Ostbutik √§r placerad p√• en hemlig plats i Sverige, n√•bar endast genom ostens guider.
            </p>
            <div class="text-dark-brown font-semibold">
              <p>Somewhere in Sweden</p>
              <p>Ostv√§gen 42</p>
              <p>Ostland, SE-99999</p>
            </div>
          </div>

          <!-- Hours -->
          <div class="bg-dark-green/10 rounded-2xl p-8">
            <h3 class="text-xl font-display font-bold text-dark-brown mb-4">
              üïê √ñppettider
            </h3>
            <div class="space-y-2 text-dark-brown/70">
              <p><span class="font-semibold">M√•n‚ÄìFre:</span> N√§r Jonte m√•r bra</p>
              <p><span class="font-semibold">L√∂rdag:</span> Ibland, kanske</p>
              <p><span class="font-semibold">S√∂ndag:</span> Aldrig, det √§r helg</p>
              <p><span class="font-semibold">Helgdagar:</span> Varf√∂r skulle man beh√∂va ost d√•?</p>
            </div>
          </div>

          <!-- Fun Fact -->
          <div class="bg-white border-2 border-dark-brown rounded-2xl p-8">
            <p class="text-lg font-display italic text-dark-brown mb-4">
              "Jonte svarar p√• e-post medan han √§ter. Ibland √§r hans svar bara 'mmmmmm', men vi f√∂rst√•r budskapet."
            </p>
            <p class="text-sm text-dark-brown/60">
              ‚Äî Ett k√§nt faktum
            </p>
          </div>
        </div>
      </div>
    </div>
  </section>

  <!-- Map Placeholder Section -->
  <section class="section-padding bg-cream">
    <div class="max-w-5xl mx-auto px-6 md:px-8">
      <h2 class="text-3xl font-display font-bold text-dark-brown mb-8 text-center">
        Var √§r vi?
      </h2>
      <div class="bg-dark-brown/10 rounded-2xl aspect-video flex items-center justify-center border-2 border-dark-brown/20">
        <div class="text-center">
          <p class="text-4xl mb-4">üó∫Ô∏è</p>
          <p class="text-dark-brown/60 font-semibold">
            H√§r skulle en interaktiv karta kunna vara,<br/>men Jonte tycker Google Maps inte f√∂rst√•r hans plats.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- FAQ Section -->
  <section class="section-padding bg-white">
    <div class="max-w-3xl mx-auto px-6 md:px-8">
      <h2 class="text-3xl font-display font-bold text-dark-brown mb-12 text-center">
        Vanliga fr√•gor
      </h2>

      <div class="space-y-6">
        <!-- FAQ Item 1 -->
        <div class="bg-cream rounded-2xl p-8">
          <h3 class="text-xl font-display font-bold text-dark-brown mb-3">
            Hur l√•ngt f√∂rv√§rt levererar ni?
          </h3>
          <p class="text-dark-brown/70">
            Vi levererar till n√§stan √∂verallt i Sverige, s√• l√§nge Jonte tycker det √§r v√§rt besv√§ret. Ibland g√∂r han det, ibland g√∂r han det inte. Det √§r en mening.
          </p>
        </div>

        <!-- FAQ Item 2 -->
        <div class="bg-cream rounded-2xl p-8">
          <h3 class="text-xl font-display font-bold text-dark-brown mb-3">
            Vad kostar en portion?
          </h3>
          <p class="text-dark-brown/70">
            Det beror p√• vilken ost. Det beror ocks√• p√• Jontes hum√∂r. Det beror p√• mycket.
          </p>
        </div>

        <!-- FAQ Item 3 -->
        <div class="bg-cream rounded-2xl p-8">
          <h3 class="text-xl font-display font-bold text-dark-brown mb-3">
            Kan jag byta en ost om jag inte gillar den?
          </h3>
          <p class="text-dark-brown/70">
            Det betyder att du inte f√∂rst√•r ost. Men ja, kontakta Jonte och sn√§ll f√∂rklara varf√∂r du inte gillar den. Han kommer att klaga p√• dig under m√•nga √•r.
          </p>
        </div>

        <!-- FAQ Item 4 -->
        <div class="bg-cream rounded-2xl p-8">
          <h3 class="text-xl font-display font-bold text-dark-brown mb-3">
            Varf√∂r heter det Jontes Ostbutik?
          </h3>
          <p class="text-dark-brown/70">
            F√∂r att det √§r Jontes ost, och Jonte s√§ljer det. Det √§r faktiskt helt logiskt om man t√§nker p√• det.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Final CTA -->
  <section class="section-padding bg-dark-green text-cream">
    <div class="max-w-3xl mx-auto px-6 md:px-8 text-center">
      <h2 class="text-3xl md:text-4xl font-display font-bold mb-6">
        Redo f√∂r din ostresa?
      </h2>
      <p class="text-lg text-cream/90 mb-8">
        Det spelar ingen roll. Jonte √§r redo f√∂r din.
      </p>
      <div class="flex flex-col sm:flex-row gap-4 justify-center">
        <a href="/" class="bg-cream text-dark-green px-8 py-3 rounded-lg font-bold hover:bg-soft-yellow transition-colors">
          Tillbaka till hem
        </a>
        <a href="/produkterna" class="bg-dark-green/70 text-cream px-8 py-3 rounded-lg font-bold hover:bg-dark-green/90 transition-colors border border-cream">
          Se alla ostar
        </a>
      </div>
    </div>
  </section>
</MainLayout>
